# 跨站(XSS)脚本攻击

### 1.什么是XSS攻击 

> 全称: Cross Site Script(跨站脚本) 为了与层叠样式表css区分，将跨站脚本简写为XSS，是代码注入的一种。

### 2.概念

> 黑客通过“HTML注入”篡改了网页，插入了恶意脚本，从而在用户在浏览网页时，实现控制用户浏览器行为的一种攻击方式。
>
> 黑客可以利用xss盗取用户的cookie，有了用户的cookie，可以以用户的身份来正常访问站点。
>
> XSS属于客户端代码注入，通常注入代码是JavaScript。区别于命令注入，SQL注入属于服务端代码注入。

### 3.XSS攻击的分类

> * 反射型
>
>   反射型就是攻击者构造出恶意的url，其中包含了恶意代码，用户点击之后，服务端取出并且返回给到前端，然后在用户端执行了恶意代码，导致用户信息泄露等损失，如网站的搜索、跳转等
>
> * DOM型
>
>   DOM型指的就是攻击者输入恶意的代码前端没有做任何过滤被执行了，然后恶意代码发送到攻击者的网站，模拟用户的行为。
>
>   从效果上来说，也属于反射型XSS。
>   攻击代码在URL里，输出在DOM节点中。
>
> * 存储型
>
>   储存型和反射型很相似，区别在于储存型是存在数据当中，而反射型是存在URL当中
>   常见的话就是商品的评论、发博文等

### 4.XSS防御

* 1、入参字符过滤

	在源头控制，把输入的一些不合法的东西都过滤掉，从而保证安全性。如移除用户提交的的DOM属性如onerror，移除用户上传的Style节点，\<iframe>, \<script>，\<a>节点等
	
* 2、出参进行编码

  将一些常见的符号，如<>在输出的时候要对其进行转换编码，这样做浏览器是不会对该标签进行解释执行的，同时也不影响显示效果。例如：对<>做编码如："\<"用:"\&lt;",">"用:"\&gt;"来代替。

* 3、入参长度限制

  xss攻击要能达成往往需要较长的字符串，因此对于一些可以预期的输入可以通过限制长度强制截断来进行防御。

* 4、设置COOKIE httponly位true

  Cookie由服务端来写并将httpOnly设置成为“true”，Cookie中设置了"HttpOnly"属性，那么通过程序(JS脚本、Applet等)将无法读取到Cookie信息，这样能有效的防止XSS攻击。